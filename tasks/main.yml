---

- name: Install zsh
  apt: name=zsh state=latest
  tags:
    - ohmyzsh

- name: Clone oh-my-zsh repo
  git: repo=https://github.com/robbyrussell/oh-my-zsh.git dest=/home/{{ item }}/.oh-my-zsh
  sudo_user: "{{ item }}"
  with_items: ohmyzsh_users
  tags:
    - ohmyzsh

- name: Copy custom theme
  copy: src=samyroad.zsh-theme dest=/home/{{ item }}/.oh-my-zsh/themes/samyroad.zsh-theme owner={{ item }} group={{ item }} mode=0644
  with_items: ohmyzsh_users
  tags:
    - ohmyzsh

- name: Copy default config
  template: src=zshrc.j2 dest=/home/{{ item }}/.zshrc mode=644
  sudo_user: "{{ item }}"
  with_items: ohmyzsh_users
  tags:
    - ohmyzsh

- name: Set zsh as default shell
  user: name={{ item }} shell=/bin/zsh
  with_items: ohmyzsh_users
  tags:
    - ohmyzsh
